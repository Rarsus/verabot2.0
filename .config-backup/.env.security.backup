# Security Configuration Template
# Copy this file to .env and fill in the values

# ============================================
# Encryption & Secrets
# ============================================

# Encryption key for sensitive data storage (64 hex characters)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=your_64_character_hex_key_here

# Secret key for HMAC signature verification (64 hex characters)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SECRET_KEY=your_64_character_hex_key_here

# ============================================
# Rate Limiting Configuration
# ============================================

# Maximum requests per time window
RATE_LIMIT_MAX_REQUESTS=100

# Time window in milliseconds (default: 60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per user per command
RATE_LIMIT_PER_USER=10

# Command cooldown in seconds
COMMAND_COOLDOWN_SECONDS=3

# ============================================
# Input Validation Configuration
# ============================================

# Maximum length for user inputs
MAX_INPUT_LENGTH=2000

# Maximum length for quote text
MAX_QUOTE_LENGTH=1000

# Maximum length for author name
MAX_AUTHOR_LENGTH=100

# Minimum length for quote text
MIN_QUOTE_LENGTH=10

# ============================================
# Security Headers
# ============================================

# Enable strict security mode (true/false)
STRICT_SECURITY_MODE=true

# Enable SQL injection detection (true/false)
ENABLE_SQL_INJECTION_DETECTION=true

# Enable XSS detection (true/false)
ENABLE_XSS_DETECTION=true

# ============================================
# Audit & Logging
# ============================================

# Enable security audit logging (true/false)
ENABLE_SECURITY_AUDIT=true

# Security log level (LOW, MEDIUM, HIGH, CRITICAL)
SECURITY_LOG_LEVEL=MEDIUM

# Log file path for security events
SECURITY_LOG_PATH=./logs/security.log

# ============================================
# Discord-Specific Security
# ============================================

# Allowed Discord roles for admin commands (comma-separated IDs)
ADMIN_ROLE_IDS=

# Allowed Discord user IDs for privileged operations (comma-separated)
PRIVILEGED_USER_IDS=

# Maximum attachment size in bytes (default: 8MB)
MAX_ATTACHMENT_SIZE=8388608

# ============================================
# Database Security
# ============================================

# Enable prepared statements (always true - do not disable)
USE_PREPARED_STATEMENTS=true

# Database backup interval in hours
DB_BACKUP_INTERVAL_HOURS=24

# Maximum database query timeout in milliseconds
DB_QUERY_TIMEOUT_MS=5000

# ============================================
# API Security
# ============================================

# Enable API request signing (true/false)
ENABLE_API_SIGNING=true

# API request timeout in milliseconds
API_TIMEOUT_MS=10000

# Maximum retry attempts for failed requests
MAX_API_RETRIES=3

# ============================================
# Development Mode
# ============================================

# Disable certain security checks in development (DO NOT USE IN PRODUCTION)
DEV_MODE=false

# Allow insecure operations in development (DO NOT USE IN PRODUCTION)
ALLOW_INSECURE_DEV=false
